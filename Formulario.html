<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <style>
      body { font-family: 'Arial', sans-serif; padding: 20px; color: #333; }
      label { display: block; margin-top: 10px; font-weight: bold; font-size: 14px; }
      input, select { width: 100%; padding: 8px; margin-top: 5px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
      button { background-color: #4CAF50; color: white; padding: 10px 15px; border: none; border-radius: 4px; cursor: pointer; width: 100%; margin-top: 20px; font-size: 16px; }
      button:disabled { background-color: #a5d6a7; cursor: not-allowed; }
      .desc { font-size: 12px; color: #666; margin-bottom: 10px; }
    </style>
  </head>
  <body>
    <h3>Perfil Nutricional</h3>
    <p class="desc">Ingresa tus datos para que Gemini diseñe tu plan personalizado.</p>
    
    <label>Edad (años)</label>
    <input type="number" id="edad" placeholder="Ej: 30">
    
    <label>Peso actual (kg)</label>
    <input type="number" id="peso" placeholder="Ej: 80">
    
    <label>Altura (cm)</label>
    <input type="number" id="altura" placeholder="Ej: 175">
    
    <label>Nivel de actividad</label>
    <select id="actividad">
      <option value="sedentario">Sedentario</option>
      <option value="moderado">Moderado (3 veces/semana)</option>
      <option value="intenso">Intenso (Deportista)</option>
    </select>

    <button id="btnEnviar" onclick="enviarDatos()">Generar Menú</button>

    <script>
      function enviarDatos() {
        const btn = document.getElementById('btnEnviar');
        btn.disabled = true;
        btn.innerText = 'Procesando (espera 2 min)...';

        const datos = {
          edad: document.getElementById('edad').value,
          peso: document.getElementById('peso').value,
          altura: document.getElementById('altura').value,
          actividad: document.getElementById('actividad').value
        };
        
        google.script.run
          .withSuccessHandler(function(msg) {
            alert(msg);
            google.script.host.close();
          })
          .withFailureHandler(function(err) {
            alert("Error: " + err);
            btn.disabled = false;
            btn.innerText = 'Generar Menú';
          })
          .procesarDatos(datos);
      }
    </script>
  </body>
</html>
